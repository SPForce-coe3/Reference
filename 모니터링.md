# Table of contents

- Installation
  - [Prerequisition](#Prerequisition)
  - [Prometheus](#Prometheus)
  - [Grafana](#Grafana)  
  - [Loki](#Loki)
  - [Cloudwatch](#Cloudwatch)

# Prerequisition
```
$ helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
  
$ helm repo add grafana https://grafana.github.io/helm-charts

$ helm repo update
```

# Prometheus
```
$ kubectl create namespace prometheus

$ helm repo add prometheus-community https://prometheus-community.github.io/helm-charts

$ helm install monitoring prometheus-community/prometheus \
    --namespace prometheus \
    --set alertmanager.persistentVolume.storageClass="gp2" \
    --set server.persistentVolume.storageClass="gp2"
```
# Grafana
```
$ mkdir ~/projects/grafana

$ cat << EoF > ~/projects/monitoring/grafana.yaml
datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
    - name: Prometheus
      type: prometheus
      url: http://prometheus-server.prometheus.svc.cluster.local
      access: proxy
      isDefault: true
EoF

$ helm install grafana grafana/grafana \
    --namespace grafana \
    --set persistence.storageClassName="gp2" \
    --set persistence.enabled=true \
    --set adminPassword='EKS!sAWSome' \
    --values ~/projects/monitoring/grafana.yaml \
    --set service.type=LoadBalancer
    
```

# Loki

https://ksr930.tistory.com/158

```
$ helm repo add grafana https://grafana.github.io/helm-charts
$ helm repo update
$ helm upgrade --install loki grafana/loki-stack --create-namespace --namespace=loki --set grafana.enabled=true,grafana.service.type=LoadBalancer,loki.config.table_manager.retention_deletes_enabled=true,loki.config.table_manager.retention_period=336h,loki.persistence.enabled=true,loki.persistence.size=5Gi
```
